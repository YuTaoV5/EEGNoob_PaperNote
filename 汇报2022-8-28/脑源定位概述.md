# 脑源定位概述
## 基本的数学背景
==麦克斯韦方程== (Maxwell’s equation) 可以解决任何与电磁场有关的问题。
麦克斯韦方程由四个公式构成：法拉第方程、麦克斯韦修正的安培电流定律、高斯定律、磁场高斯定律。即：

$$ \left\{\begin{array}{c}\nabla \times \mathbf{E}=-\frac{\partial \mathbf{B}}{\partial t} \\ \nabla \times \mathbf{B}=\mu_{0} \mathbf{J}+\mu_{0} \epsilon_{0} \frac{\partial \mathbf{E}}{\partial t} \\ \nabla \bullet \mathbf{E}=\frac{\rho}{\epsilon_{0}} \\ \nabla \bullet \mathbf{B}=0\end{array}\right. $$
| 符号 | 含义 |
| -- | -- |
|$\epsilon_{0}$|自由空间中的介电常数|
|$\mu_{0}$|自由空间中的磁导率|
这些方程简单定义了基本物理量 **电场** 和 **磁场** (E 和 B) 如何由彼此的变化和**电荷密度** (ρ)、**电流密度** (J) 的影响而产生的。时间导数表明电场的变化会产生磁场，反之亦然。以上的方程可以合成一个**波动方程**，用来表述电场和磁场如何空间中传播的.

生物组织中的电场可以近似表示为 ==线性模型== (无源、均匀、各向同性)；又因为脑电场的时间变化因素几乎可以忽略不计，所以大脑中的电磁场可以等效准静态电磁场来处理。于是，麦克斯韦方程可以简化为：
$$\\ \left\{\begin{array}{l}\nabla \times \mathbf{E}=0 \\ \nabla \times \mathbf{B}=\mu_{0} \mathbf{J} \\ \nabla \bullet \mathbf{E}=\frac{\rho}{\epsilon_{0}} \\ \nabla \bullet \mathbf{B}=0 \end{array}\right. $$
**电流密度** $J(A/m^2)$ 与**电场** $E(V/m)$之间的关系由欧姆定律给出：$J = σE$，其中 σ 为媒质的磁导率。
## 脑电正问题
脑电正问题的数学框架可以由准静态条件下的麦克斯韦方程得出。假设
- $E = E(r, t)$
- $B = B(r, t)$ 
- $J = J(r, t)$ 

分别是在位置 $rϵR^3$ 和时间 $t$ 的**电场**和**磁场**和**电流密度**；根据上文公式的第一,二个方程引入标量电压 $V = V(r, t)$ 得到：
$$\\ E=-\nabla V \\ \nabla \bullet J=0 $$
在大脑空间中，电流密度 J 是两个分量的叠加：

$$ J=J_{p}+J_{v} $$
其中初始电流 $J_p$ 通过轴突激发被动的体电流密度 $J_v$，这就解决了局部电路的欧姆
定律。
$$ J_{v}(r, t)=\sigma(r) E(r, t) $$
其中 $σ(r)$，是位于 r 处组织的电导率。结合公式可得：
$$ \nabla \bullet J_{p}(r, t)=-\nabla \bullet(\sigma(r) \nabla V(r, t)) $$
这个方程被称为关于**电势** V（任意电导率和绝缘边界的各向同性介质中）的==泊松方程==，定义了 EEG 信号形成的**正问题模型**，事实上，假设电导率是已知的，同时给出一个**矢量场** $J_p = J_p(r, t)$, 于是方程在颅骨采样点 $r_1,...,r_N$ 上的**数值解**提供了放置在头皮上的电极在相应点上的 EEG 时间序列信号。

假如我们从头皮表面的电极所获取的数据为 V, 在每个时刻 t 由大量神经元活动所引起的起始**电流密度**为 J，那么可以得到==第一类弗雷德霍姆积分方程== (Type I Fredholm Integral Equation)：
$$ V\left(r_{e}, t\right)=\int K\left(r_{e}, t\right) \bullet J(r, t) d r^{3} $$
其中，$K(r_e, t)$ 称之为电场引导场 (Electric Lead Field，ELF)，将大脑源活动的位置 r 映射到测量电极的位置 $r_e$，ELF 可以通过麦克斯韦方程的准静态近似和头模型的几何和电学特性计算得出。

## 脑电逆问题
::: tip
脑电逆问题可以定义为在已知 V 和 ELF 的情况下，估算参数 J。
:::
实践中方程$V\left(r_{e}, t\right)=\int K\left(r_{e}, t\right) \bullet J(r, t) d r^{3}$的==离散形式==是一个线性系统表示为：
$$ V=K J+e $$

| 符号 | 含义 |
| -- | -- |
|未知参数 J|由 S\*T 的矩阵构成,用来表示初始电流密度|
|T|是时间点的数量|
|S|是源空间中源的数量|
|V|是 N\*T 的矩阵, 表示N个电极测量到的 EEG 数据|
|e|是 N\*T 的矩阵, 表示N个电极测量到的 EEG 噪声|
|K|离散化后的 ELF 是一个 N\*S 的病态矩阵|

因为大脑区域的源活动点通常由成千上万的体素构成，所以出现 N 远远小于 S 以及线性方程, 是欠定的问题（方程的解不唯一）。
![Img](https://imgpool.protodrive.xyz/img/yank-note-picgo-img-20220828152220.png#pic_center%20=400x)

## 方法
脑电信号源的估计是神经科学中的一个逆问题。由于解的非唯一性，这是一个不适定问题，需要正则化或先验信息来进行电生理源成像。结构化稀疏性先验可以通过（基于L1范数）和（基于L2范数）约束的组合来获得，例如Elastic Net（ENET）和Elitist Lasso（ELASSO）模型。

## 研究现状
脑电让我们可以通过在头皮放置电极从而以无侵入式的方式记录神经活动，但同时这种非侵入式的方法也存在一定的局限性。
::: tip 局限性
神经元产生的神经活动必须通过神经组织、脑脊液、头皮和颅骨传播 (即改变信号原始特性的电阻组织层)，然后才能到达表面电极。最重要的是，产生电活动的神经元并不是孤立的，而是嵌入在一个由神经元组成的复杂网络中，这些神经元不断地激活并产生自己的电活动。在神经信号到达头皮电极之前的所有这些失真信号被归因为 **容积效应** (volume conduction effects)，在技术上被定义为电场 (或磁场) 通过生物组织到达测量传感器时所产生的失真。由于这些通过组织的失真信号的传导，头皮传感器只能记录其所在位置以下几厘米处产生的大脑活动。从另一方面说，头皮上所在传感器的每个位置，记录的大脑活动反映出的是在该位置周围几厘米范围内的脑电源活动的==加权和==。
::: 
尽管有这些失真现象，脑电图仍然是研究大脑活动的**最重要**的方法之一。虽然容积效应将我们限制在大约 5-9 厘米的空间分辨率，但它保持了毫秒尺度上的时间分辨率，与所有其他研究神经系统的方法相比相对来说是最高的。如果能够突破容积效应的影响，并提高空间分辨率，EEG 作为神经影像研究方法将发挥**极大的优势**。
![Img](https://imgpool.protodrive.xyz/img/yank-note-picgo-img-20220828214910.png#pic_center%20=400x)
::: tip 逆问题的困难
EEG 逆问题是一个==病态== (ill-posed) 问题, 因为对任何可采用的输出电压来说，逆问题的解都是不唯一的而且是不稳定的（逆问题的解对噪音数据的微小改变高度敏感）。过去的许多工作都是通过分析头皮层面的电极信号相关性来进行脑功能连接分析。事实上，这些对大脑信号的分析方法由于**没有精确的匹配相关的脑区**而**缺乏充分的生理或解剖学意义**。因此，忽略容积效应的这些方法而试图通过分析头皮脑电的模式来反映头皮之下的大脑活动，这在最近几年受到了神经科学领域**广泛的质疑和挑战**。
:::
近些年来，从头皮脑电数据重建大脑皮层活动方面取得了显著进展，一系列的脑电逆问题或源重建的方法被提出。但是几乎所有基于电生理源成像的方法都有一定的限制，在这些技术限制的基础上，我们仍然有很大的改进空间。

目前为止，M/EEG (Magneto/Electroencephalographic) 以贝叶斯形式的源分析模型可分为三类用以说明如何利用关于连接性的先验信息 (协方差或精度) 来实现溯源分析。
::: tip 常用方法
- 第一类，在用线性公式求解估计源活动时，使用**固定的协方差结构**。
例如：==最小范数== (Minimum Norm，MN) 和==低分辨率脑电磁层析成像==（Low Resolution Brain Electromagnetic Tomography，LORETA）。
- 第二类，考虑源活动和对角协方差结构的**嵌入先验**，同时由源活动和连接性的**非线性相关公式**来进行估计。
例如：(Exact LORETA ，eLORETA), ==多重惩罚最小二乘== (Multiple Penalized Least Squares，MPLS) 和 ==结构化稀疏贝叶斯学习== (Structured Sparse Bayesian Learning，SSBL) 
- 第三类，虽然与第二类相似但是**具有全协方差结构**
  例如：==可变分辨率层析成像分析== (Variable Resolution Tomographic Analysis，VARETA)和==受限似然最大化== (Restricted Likelihood Maximization，ReLM)
:::